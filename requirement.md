Excel AI 插件开发需求文档
一、项目概述
本项目旨在开发一款服务于财务人员的 Excel 插件，借助大模型能力智能处理复杂公式，提升其数据处理效率与准确性。

二、核心功能模块
1. 自然语言生成 Excel 公式
用户输入自然语言描述（如："计算每个月的净利润率"）

系统解析意图，调用预设函数库模板生成标准 Excel 公式

生成公式后自动填入选中单元格

2. 公式解释器
用户粘贴已有 Excel 公式

系统逐层解析其结构与作用

返回中文解释，便于理解和教学

3. 优化建议与增强
检查公式可读性与性能

提供更简洁、可维护的写法建议

输出建议版本 + 改写说明

4. 错误诊断与修复提示
识别常见错误：如 #REF!, #DIV/0!, #NAME?

提供错误原因解释与修复建议

支持点击修复（建议版本可直接替换）

三、技术架构
前端（Excel 插件部分）
技术栈：React + TypeScript + Office.js

插件形式：任务窗格插件 (Task Pane Add-in)

UI 要求：

简洁现代，支持中文界面

支持公式预览、解释、复制、一键插入

后端（AI 接口服务）
技术栈：Python + FastAPI

模块功能：

接收用户自然语言/公式

调用大模型 DeepSeek（API 或本地推理）

返回生成/解释/优化/修复结果

数据库
使用 PostgreSQL

功能：记录用户历史请求（可选）、错误案例库（优化建议来源）

四、AI 能力调用说明
大模型：DeepSeek
应用方式：

解析自然语言为公式意图

基于内置函数模板库 + 意图组合生成公式

提供公式的中文解释

输出改写建议 + 错误修复意见

示例 Prompt：

markdown
复制
编辑
用户输入：请帮我计算每月销售增长率
模型任务：
  - 分析意图：增长率计算
  - 生成公式：=(本月销售-上月销售)/上月销售
  - 输出公式：=(B3-B2)/B2
  - 解释：B2 为上月销售，B3 为本月销售，计算环比增长率
五、开发阶段规划
环境初始化

创建插件项目（使用 Yo Office）

搭建 FastAPI 服务 + PostgreSQL 数据库

模块开发顺序

自然语言转公式

公式解析器

优化建议系统

错误识别与修复

测试计划

关键功能单测 + 插件端集成测试

常见财务公式用例覆盖测试

部署

后端部署至阿里云（支持 API 扩展）

插件发布至 Excel 插件商店（或私有部署）

六、补充说明
用户群体：财务分析师、会计师、财务BP 等

插件需长期支持中文优先